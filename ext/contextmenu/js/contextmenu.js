!function(a){"function"===typeof define&&define.amd?define(["jquery"],a):a("object"===typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function n(a){for(var e,b=a.split(/\s+/),c=[],d=0;e=b[d];d++)e=e.charAt(0).toUpperCase(),c.push(e);return c}function o(b){return b.id&&a('label[for="'+b.id+'"]').val()||b.name}function p(b,c,d){return d||(d=0),c.each(function(){var g,h,c=a(this),e=this,f=this.nodeName.toLowerCase();switch("label"===f&&c.find("input, textarea, select").length&&(g=c.text(),c=c.children().first(),e=c.get(0),f=e.nodeName.toLowerCase()),f){case"menu":h={name:c.attr("label"),items:{}},d=p(h.items,c.children(),d);break;case"a":case"button":h={name:c.text(),disabled:!!c.attr("disabled"),callback:function(){return function(){c.get(0).click()}}()};break;case"menuitem":case"command":switch(c.attr("type")){case void 0:case"command":case"menuitem":h={name:c.attr("label"),disabled:!!c.attr("disabled"),icon:c.attr("icon"),callback:function(){return function(){c.get(0).click()}}()};break;case"checkbox":h={type:"checkbox",disabled:!!c.attr("disabled"),name:c.attr("label"),selected:!!c.attr("checked")};break;case"radio":h={type:"radio",disabled:!!c.attr("disabled"),name:c.attr("label"),radio:c.attr("radiogroup"),value:c.attr("id"),selected:!!c.attr("checked")};break;default:h=void 0}break;case"hr":h="-------";break;case"input":switch(c.attr("type")){case"text":h={type:"text",name:g||o(e),disabled:!!c.attr("disabled"),value:c.val()};break;case"checkbox":h={type:"checkbox",name:g||o(e),disabled:!!c.attr("disabled"),selected:!!c.attr("checked")};break;case"radio":h={type:"radio",name:g||o(e),disabled:!!c.attr("disabled"),radio:!!c.attr("name"),value:c.val(),selected:!!c.attr("checked")};break;default:h=void 0}break;case"select":h={type:"select",name:g||o(e),disabled:!!c.attr("disabled"),selected:c.val(),options:{}},c.children().each(function(){h.options[this.value]=a(this).text()});break;case"textarea":h={type:"textarea",name:g||o(e),disabled:!!c.attr("disabled"),value:c.val()};break;case"label":break;default:h={type:"html",html:c.clone(!0)}}h&&(d++,b["key"+d]=h)}),d}a.support.htmlMenuitem="HTMLMenuItemElement"in window,a.support.htmlCommand="HTMLCommandElement"in window,a.support.eventSelectstart="onselectstart"in document.documentElement,a.ui&&a.widget||(a.cleanData=function(b){return function(c){var d,e,f;for(f=0;null!=c[f];f++){e=c[f];try{d=a._data(e,"events"),d&&d.remove&&a(e).triggerHandler("remove")}catch(g){}}b(c)}}(a.cleanData));var b=null,c=!1,d=a(window),e=0,f={},g={},h={},i={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,hideOnSecondTrigger:!1,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(b){if(a.ui&&a.ui.position)b.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var c=this.offset();c.top+=this.outerHeight(),c.left+=this.outerWidth()/2-b.outerWidth()/2,b.css(c)}},position:function(a,b,c){var e;if(!b&&!c)return void a.determinePosition.call(this,a.$menu);if("maintain"===b&&"maintain"===c)e=a.$menu.position();else{var f=a.$menu.offsetParent().offset();e={top:c-f.top,left:b-f.left}}var g=d.scrollTop()+d.height(),h=d.scrollLeft()+d.width(),i=a.$menu.outerHeight(),j=a.$menu.outerWidth();e.top+i>g&&(e.top-=i),e.top<0&&(e.top=0),e.left+j>h&&(e.left-=j),e.left<0&&(e.left=0),a.$menu.css(e)},positionSubmenu:function(b){if("undefined"!==typeof b)if(a.ui&&a.ui.position)b.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var c={top:-9,left:this.outerWidth()-5};b.css(c)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:a.noop,hide:a.noop,activated:a.noop},callback:null,items:{}},j={timer:null,pageX:null,pageY:null},k=function(a){for(var b=0,c=a;;)if(b=Math.max(b,parseInt(c.css("z-index"),10)||0),c=c.parent(),!c||!c.length||"html body".indexOf(c.prop("nodeName").toLowerCase())>-1)break;return b},l={abortevent:function(a){a.preventDefault(),a.stopImmediatePropagation()},contextmenu:function(c){var d=a(this);if("right"===c.data.trigger&&(c.preventDefault(),c.stopImmediatePropagation()),("right"===c.data.trigger||"demand"===c.data.trigger||!c.originalEvent)&&("undefined"===typeof c.mouseButton||!c.data||"left"===c.data.trigger&&0===c.mouseButton||"right"===c.data.trigger&&2===c.mouseButton)&&!d.hasClass("context-menu-active")&&!d.hasClass("context-menu-disabled")){if(b=d,c.data.build){var e=c.data.build(b,c);if(e===!1)return;if(c.data=a.extend(!0,{},i,c.data,e||{}),!c.data.items||a.isEmptyObject(c.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");c.data.$trigger=b,m.create(c.data)}var f=!1;for(var g in c.data.items)if(c.data.items.hasOwnProperty(g)){var h;h=a.isFunction(c.data.items[g].visible)?c.data.items[g].visible.call(a(c.currentTarget),g,c.data):"undefined"!==typeof c.data.items[g]&&c.data.items[g].visible?c.data.items[g].visible===!0:!0,h&&(f=!0)}f&&m.show.call(d,c.data,c.pageX,c.pageY)}},click:function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).trigger(a.Event("contextmenu",{data:b.data,pageX:b.pageX,pageY:b.pageY}))},mousedown:function(c){var d=a(this);b&&b.length&&!b.is(d)&&b.data("contextMenu").$menu.trigger("contextmenu:hide"),2===c.button&&(b=d.data("contextMenuActive",!0))},mouseup:function(c){var d=a(this);d.data("contextMenuActive")&&b&&b.length&&b.is(d)&&!d.hasClass("context-menu-disabled")&&(c.preventDefault(),c.stopImmediatePropagation(),b=d,d.trigger(a.Event("contextmenu",{data:c.data,pageX:c.pageX,pageY:c.pageY}))),d.removeData("contextMenuActive")},mouseenter:function(c){var d=a(this),e=a(c.relatedTarget),f=a(document);e.is(".context-menu-list")||e.closest(".context-menu-list").length||b&&b.length||(j.pageX=c.pageX,j.pageY=c.pageY,j.data=c.data,f.on("mousemove.contextMenuShow",l.mousemove),j.timer=setTimeout(function(){j.timer=null,f.off("mousemove.contextMenuShow"),b=d,d.trigger(a.Event("contextmenu",{data:j.data,pageX:j.pageX,pageY:j.pageY}))},c.data.delay))},mousemove:function(a){j.pageX=a.pageX,j.pageY=a.pageY},mouseleave:function(b){var c=a(b.relatedTarget);if(!c.is(".context-menu-list")&&!c.closest(".context-menu-list").length){try{clearTimeout(j.timer)}catch(b){}j.timer=null}},layerClick:function(b){var j,k,c=a(this),e=c.data("contextMenuRoot"),f=b.button,g=b.pageX,h=b.pageY,i=void 0===g;b.preventDefault(),setTimeout(function(){if(i)return void(null!==e&&"undefined"!==typeof e&&null!==e.$menu&&"undefined"!==typeof e.$menu&&e.$menu.trigger("contextmenu:hide"));var c,l="left"===e.trigger&&0===f||"right"===e.trigger&&2===f;if(document.elementFromPoint&&e.$layer){if(e.$layer.hide(),j=document.elementFromPoint(g-d.scrollLeft(),h-d.scrollTop()),j.isContentEditable){var m=document.createRange(),n=window.getSelection();m.selectNode(j),m.collapse(!0),n.removeAllRanges(),n.addRange(m)}a(j).trigger(b),e.$layer.show()}if(e.hideOnSecondTrigger&&l&&null!==e.$menu&&"undefined"!==typeof e.$menu)return void e.$menu.trigger("contextmenu:hide");if(e.reposition&&l)if(document.elementFromPoint){if(e.$trigger.is(j))return void e.position.call(e.$trigger,e,g,h)}else if(k=e.$trigger.offset(),c=a(window),k.top+=c.scrollTop(),k.top<=b.pageY&&(k.left+=c.scrollLeft(),k.left<=b.pageX&&(k.bottom=k.top+e.$trigger.outerHeight(),k.bottom>=b.pageY&&(k.right=k.left+e.$trigger.outerWidth(),k.right>=b.pageX))))return void e.position.call(e.$trigger,e,g,h);j&&l&&e.$trigger.one("contextmenu:hidden",function(){a(j).contextMenu({x:g,y:h,button:f})}),null!==e&&"undefined"!==typeof e&&null!==e.$menu&&"undefined"!==typeof e.$menu&&e.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault(),a.stopPropagation()},key:function(a){var c={};b&&(c=b.data("contextMenu")||{}),"undefined"===typeof c.zIndex&&(c.zIndex=0);var d=0,e=function(a){""!==a.style.zIndex?d=a.style.zIndex:null!==a.offsetParent&&"undefined"!==typeof a.offsetParent?e(a.offsetParent):null!==a.parentElement&&"undefined"!==typeof a.parentElement&&e(a.parentElement)};if(e(a.target),!(c.$menu&&parseInt(d,10)>parseInt(c.$menu.css("zIndex"),10))){switch(a.keyCode){case 9:case 38:if(l.keyStop(a,c),c.isInput){if(9===a.keyCode&&a.shiftKey)return a.preventDefault(),c.$selected&&c.$selected.find("input, textarea, select").blur(),void(null!==c.$menu&&"undefined"!==typeof c.$menu&&c.$menu.trigger("prevcommand"));if(38===a.keyCode&&"checkbox"===c.$selected.find("input, textarea, select").prop("type"))return void a.preventDefault()}else if(9!==a.keyCode||a.shiftKey)return void(null!==c.$menu&&"undefined"!==typeof c.$menu&&c.$menu.trigger("prevcommand"));break;case 40:if(l.keyStop(a,c),!c.isInput)return void(null!==c.$menu&&"undefined"!==typeof c.$menu&&c.$menu.trigger("nextcommand"));if(9===a.keyCode)return a.preventDefault(),c.$selected&&c.$selected.find("input, textarea, select").blur(),void(null!==c.$menu&&"undefined"!==typeof c.$menu&&c.$menu.trigger("nextcommand"));if(40===a.keyCode&&"checkbox"===c.$selected.find("input, textarea, select").prop("type"))return void a.preventDefault();break;case 37:if(l.keyStop(a,c),c.isInput||!c.$selected||!c.$selected.length)break;if(!c.$selected.parent().hasClass("context-menu-root")){var f=c.$selected.parent().parent();return c.$selected.trigger("contextmenu:blur"),void(c.$selected=f)}break;case 39:if(l.keyStop(a,c),c.isInput||!c.$selected||!c.$selected.length)break;var g=c.$selected.data("contextMenu")||{};if(g.$menu&&c.$selected.hasClass("context-menu-submenu"))return c.$selected=null,g.$selected=null,void g.$menu.trigger("nextcommand");break;case 35:case 36:return c.$selected&&c.$selected.find("input, textarea, select").length?void 0:((c.$selected&&c.$selected.parent()||c.$menu).children(":not(."+c.classNames.disabled+", ."+c.classNames.notSelectable+")")[36===a.keyCode?"first":"last"]().trigger("contextmenu:focus"),void a.preventDefault());case 13:if(l.keyStop(a,c),c.isInput){if(c.$selected&&!c.$selected.is("textarea, select"))return void a.preventDefault();break}return void("undefined"!==typeof c.$selected&&null!==c.$selected&&c.$selected.trigger("mouseup"));case 32:case 33:case 34:return void l.keyStop(a,c);case 27:return l.keyStop(a,c),void(null!==c.$menu&&"undefined"!==typeof c.$menu&&c.$menu.trigger("contextmenu:hide"));default:var h=String.fromCharCode(a.keyCode).toUpperCase();if(c.accesskeys&&c.accesskeys[h])return void c.accesskeys[h].$node.trigger(c.accesskeys[h].$menu?"contextmenu:focus":"mouseup")}a.stopPropagation(),"undefined"!==typeof c.$selected&&null!==c.$selected&&c.$selected.trigger(a)}},prevItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{},d=a(this).data("contextMenuRoot")||{};if(c.$selected){var e=c.$selected;c=c.$selected.parent().data("contextMenu")||{},c.$selected=e}for(var f=c.$menu.children(),g=c.$selected&&c.$selected.prev().length?c.$selected.prev():f.last(),h=g;g.hasClass(d.classNames.disabled)||g.hasClass(d.classNames.notSelectable)||g.is(":hidden");)if(g=g.prev().length?g.prev():f.last(),g.is(h))return;c.$selected&&l.itemMouseleave.call(c.$selected.get(0),b),l.itemMouseenter.call(g.get(0),b);var i=g.find("input, textarea, select");i.length&&i.focus()},nextItem:function(b){b.stopPropagation();var c=a(this).data("contextMenu")||{},d=a(this).data("contextMenuRoot")||{};if(c.$selected){var e=c.$selected;c=c.$selected.parent().data("contextMenu")||{},c.$selected=e}for(var f=c.$menu.children(),g=c.$selected&&c.$selected.next().length?c.$selected.next():f.first(),h=g;g.hasClass(d.classNames.disabled)||g.hasClass(d.classNames.notSelectable)||g.is(":hidden");)if(g=g.next().length?g.next():f.first(),g.is(h))return;c.$selected&&l.itemMouseleave.call(c.$selected.get(0),b),l.itemMouseenter.call(g.get(0),b);var i=g.find("input, textarea, select");i.length&&i.focus()},focusInput:function(){var b=a(this).closest(".context-menu-item"),c=b.data(),d=c.contextMenu,e=c.contextMenuRoot;e.$selected=d.$selected=b,e.isInput=d.isInput=!0},blurInput:function(){var b=a(this).closest(".context-menu-item"),c=b.data(),d=c.contextMenu,e=c.contextMenuRoot;e.isInput=d.isInput=!1},menuMouseenter:function(){var b=a(this).data().contextMenuRoot;b.hovering=!0},menuMouseleave:function(b){var c=a(this).data().contextMenuRoot;c.$layer&&c.$layer.is(b.relatedTarget)&&(c.hovering=!1)},itemMouseenter:function(b){var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;return f.hovering=!0,b&&f.$layer&&f.$layer.is(b.relatedTarget)&&(b.preventDefault(),b.stopImmediatePropagation()),(e.$menu?e:f).$menu.children("."+f.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur"),c.hasClass(f.classNames.disabled)||c.hasClass(f.classNames.notSelectable)?void(e.$selected=null):void c.trigger("contextmenu:focus")},itemMouseleave:function(b){var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;return f!==e&&f.$layer&&f.$layer.is(b.relatedTarget)?("undefined"!==typeof f.$selected&&null!==f.$selected&&f.$selected.trigger("contextmenu:blur"),b.preventDefault(),b.stopImmediatePropagation(),void(f.$selected=e.$selected=e.$node)):void(e&&e.$menu&&e.$menu.hasClass("context-menu-visible")||c.trigger("contextmenu:blur"))},itemClick:function(b){var h,c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot,g=d.contextMenuKey;if(!(!e.items[g]||c.is("."+f.classNames.disabled+", .context-menu-separator, ."+f.classNames.notSelectable)||c.is(".context-menu-submenu")&&f.selectableSubMenu===!1)){if(b.preventDefault(),b.stopImmediatePropagation(),a.isFunction(e.callbacks[g])&&Object.prototype.hasOwnProperty.call(e.callbacks,g))h=e.callbacks[g];else{if(!a.isFunction(f.callback))return;h=f.callback}h.call(f.$trigger,g,f,b)!==!1?f.$menu.trigger("contextmenu:hide"):f.$menu.parent().length&&m.update.call(f.$trigger,f)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(b,c){var d=a(this).data("contextMenuRoot");m.hide.call(d.$trigger,d,c&&c.force)},focusItem:function(b){b.stopPropagation();var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;c.hasClass(f.classNames.disabled)||c.hasClass(f.classNames.notSelectable)||(c.addClass([f.classNames.hover,f.classNames.visible].join(" ")).parent().find(".context-menu-item").not(c).removeClass(f.classNames.visible).filter("."+f.classNames.hover).trigger("contextmenu:blur"),e.$selected=f.$selected=c,e&&e.$node&&e.$node.hasClass("context-menu-submenu")&&e.$node.addClass(f.classNames.hover),e.$node&&f.positionSubmenu.call(e.$node,e.$menu))},blurItem:function(b){b.stopPropagation();var c=a(this),d=c.data(),e=d.contextMenu,f=d.contextMenuRoot;e.autoHide&&c.removeClass(f.classNames.visible),c.removeClass(f.classNames.hover),e.$selected=null}},m={show:function(c,d,e){var f=a(this),g={};if(a("#context-menu-layer").trigger("mousedown"),c.$trigger=f,c.events.show.call(f,c)===!1)return void(b=null);if(m.update.call(f,c),c.position.call(f,c,d,e),c.zIndex){var h=c.zIndex;"function"===typeof c.zIndex&&(h=c.zIndex.call(f,c)),g.zIndex=k(f)+h}m.layer.call(c.$menu,c,g.zIndex),c.$menu.find("ul").css("zIndex",g.zIndex+1),c.$menu.css(g)[c.animation.show](c.animation.duration,function(){f.trigger("contextmenu:visible"),m.activated(c),c.events.activated(c)}),f.data("contextMenu",c).addClass("context-menu-active"),a(document).off("keydown.contextMenu").on("keydown.contextMenu",l.key),c.autoHide&&a(document).on("mousemove.contextMenuAutoHide",function(a){var b=f.offset();b.right=b.left+f.outerWidth(),b.bottom=b.top+f.outerHeight(),!c.$layer||c.hovering||a.pageX>=b.left&&a.pageX<=b.right&&a.pageY>=b.top&&a.pageY<=b.bottom||setTimeout(function(){c.hovering||null===c.$menu||"undefined"===typeof c.$menu||c.$menu.trigger("contextmenu:hide")},50)})},hide:function(c,d){var e=a(this);if(c||(c=e.data("contextMenu")||{}),d||!c.events||c.events.hide.call(e,c)!==!1){if(e.removeData("contextMenu").removeClass("context-menu-active"),c.$layer){setTimeout(function(a){return function(){a.remove()}}(c.$layer),10);try{delete c.$layer}catch(f){c.$layer=null}}b=null,c.$menu.find("."+c.classNames.hover).trigger("contextmenu:blur"),c.$selected=null,c.$menu.find("."+c.classNames.visible).removeClass(c.classNames.visible),a(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),c.$menu&&c.$menu[c.animation.hide](c.animation.duration,function(){c.build&&(c.$menu.remove(),a.each(c,function(a){switch(a){case"ns":case"selector":case"build":case"trigger":return!0;default:c[a]=void 0;try{delete c[a]}catch(b){}return!0}})),setTimeout(function(){e.trigger("contextmenu:hidden")},10)})}},create:function(b,c){function d(b){var c=a("<span></span>");if(b._accesskey)b._beforeAccesskey&&c.append(document.createTextNode(b._beforeAccesskey)),a("<span></span>").addClass("context-menu-accesskey").text(b._accesskey).appendTo(c),b._afterAccesskey&&c.append(document.createTextNode(b._afterAccesskey));else if(b.isHtmlName){if("undefined"!==typeof b.accesskey)throw new Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");c.html(b.name)}else c.text(b.name);return c}"undefined"===typeof c&&(c=b),b.$menu=a('<ul class="context-menu-list"></ul>').addClass(b.className||"").data({contextMenu:b,contextMenuRoot:c}),a.each(["callbacks","commands","inputs"],function(a,d){b[d]={},c[d]||(c[d]={})}),c.accesskeys||(c.accesskeys={}),a.each(b.items,function(e,f){var g=a('<li class="context-menu-item"></li>').addClass(f.className||""),i=null,j=null;if(g.on("click",a.noop),("string"===typeof f||"cm_separator"===f.type)&&(f={type:"cm_seperator"}),f.$node=g.data({contextMenu:b,contextMenuRoot:c,contextMenuKey:e}),"undefined"!==typeof f.accesskey)for(var p,k=n(f.accesskey),o=0;p=k[o];o++)if(!c.accesskeys[p]){c.accesskeys[p]=f;var q=f.name.match(new RegExp("^(.*?)("+p+")(.*)$","i"));q&&(f._beforeAccesskey=q[1],f._accesskey=q[2],f._afterAccesskey=q[3]);break}if(f.type&&h[f.type])h[f.type].call(g,f,b,c),a.each([b,c],function(c,d){d.commands[e]=f,!a.isFunction(f.callback)||"undefined"!==typeof d.callbacks[e]&&"undefined"!==typeof b.type||(d.callbacks[e]=f.callback)});else{switch("cm_seperator"===f.type?g.addClass("context-menu-separator "+c.classNames.notSelectable):"html"===f.type?g.addClass("context-menu-html "+c.classNames.notSelectable):"sub"===f.type||(f.type?(i=a("<label></label>").appendTo(g),d(f).appendTo(i),g.addClass("context-menu-input"),b.hasTypes=!0,a.each([b,c],function(a,b){b.commands[e]=f,b.inputs[e]=f})):f.items&&(f.type="sub")),f.type){case"cm_seperator":break;case"text":j=a('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+e).val(f.value||"").appendTo(i);break;case"textarea":j=a('<textarea name=""></textarea>').attr("name","context-menu-input-"+e).val(f.value||"").appendTo(i),f.height&&j.height(f.height);break;case"checkbox":j=a('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+e).val(f.value||"").prop("checked",!!f.selected).prependTo(i);break;case"radio":j=a('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+f.radio).val(f.value||"").prop("checked",!!f.selected).prependTo(i);break;case"select":j=a('<select name=""></select>').attr("name","context-menu-input-"+e).appendTo(i),f.options&&(a.each(f.options,function(b,c){a("<option></option>").val(b).text(c).appendTo(j)}),j.val(f.selected));break;case"sub":d(f).appendTo(g),f.appendTo=f.$node,g.data("contextMenu",f).addClass("context-menu-submenu"),f.callback=null,"function"===typeof f.items.then?m.processPromises(f,c,f.items):m.create(f,c);break;case"html":a(f.html).appendTo(g);break;default:a.each([b,c],function(c,d){d.commands[e]=f,!a.isFunction(f.callback)||"undefined"!==typeof d.callbacks[e]&&"undefined"!==typeof b.type||(d.callbacks[e]=f.callback)}),d(f).appendTo(g)}f.type&&"sub"!==f.type&&"html"!==f.type&&"cm_seperator"!==f.type&&(j.on("focus",l.focusInput).on("blur",l.blurInput),f.events&&j.on(f.events,b)),f.icon&&(f._icon=a.isFunction(f.icon)?f.icon.call(this,this,g,e,f):"string"===typeof f.icon&&"fa-"===f.icon.substring(0,3)?c.classNames.icon+" "+c.classNames.icon+"--fa fa "+f.icon:c.classNames.icon+" "+c.classNames.icon+"-"+f.icon,g.addClass(f._icon))}f.$input=j,f.$label=i,g.appendTo(b.$menu),!b.hasTypes&&a.support.eventSelectstart&&g.on("selectstart.disableTextSelect",l.abortevent)}),b.$node||b.$menu.css("display","none").addClass("context-menu-root"),b.$menu.appendTo(b.appendTo||document.body)},resize:function(b,c){var d;b.css({position:"absolute",display:"block"}),b.data("width",(d=b.get(0)).getBoundingClientRect?Math.ceil(d.getBoundingClientRect().width):b.outerWidth()+1),b.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),b.find("> li > ul").each(function(){m.resize(a(this),!0)}),c||b.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return a(this).data("width")})},update:function(b,c){var d=this;"undefined"===typeof c&&(c=b,m.resize(b.$menu)),b.$menu.children().each(function(){var i,e=a(this),f=e.data("contextMenuKey"),g=b.items[f],h=a.isFunction(g.disabled)&&g.disabled.call(d,f,c)||g.disabled===!0;if(i=a.isFunction(g.visible)?g.visible.call(d,f,c):"undefined"!==typeof g.visible?g.visible===!0:!0,e[i?"show":"hide"](),e[h?"addClass":"removeClass"](c.classNames.disabled),a.isFunction(g.icon)&&(e.removeClass(g._icon),g._icon=g.icon.call(this,d,e,f,g),e.addClass(g._icon)),g.type)switch(e.find("input, select, textarea").prop("disabled",h),g.type){case"text":case"textarea":g.$input.val(g.value||"");break;case"checkbox":case"radio":g.$input.val(g.value||"").prop("checked",!!g.selected);break;case"select":g.$input.val((0===g.selected?"0":g.selected)||"")}g.$menu&&m.update.call(d,g,c)})},layer:function(b,c){var e=b.$layer=a('<div id="context-menu-layer"></div>').css({height:d.height(),width:d.width(),display:"block",position:"fixed","z-index":c,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",b).insertBefore(this).on("contextmenu",l.abortevent).on("mousedown",l.layerClick);return"undefined"===typeof document.body.style.maxWidth&&e.css({position:"absolute",height:a(document).height()}),e},processPromises:function(a,b,c){function d(a,b,c){"undefined"===typeof c&&e(void 0),f(a,b,c)}function e(a,b,c){"undefined"===typeof c?(c={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):"string"===typeof c&&(c={error:{name:c}}),f(a,b,c)}function f(a,b,c){"undefined"!==typeof b.$menu&&b.$menu.is(":visible")&&(a.$node.removeClass(b.classNames.iconLoadingClass),a.items=c,m.create(a,b,!0),m.update(a,b),b.positionSubmenu.call(a.$node,a.$menu))}a.$node.addClass(b.classNames.iconLoadingClass),c.then(d.bind(this,a,b),e.bind(this,a,b))},activated:function(b){var c=b.$menu,d=c.offset(),e=a(window).height(),f=a(window).scrollTop(),g=c.height();g>e?c.css({height:e+"px","overflow-x":"hidden","overflow-y":"auto",top:f+"px"}):(d.top<f||d.top+g>f+e)&&c.css({top:"0px"})}};a.fn.contextMenu=function(b){var c=this,d=b;if(this.length>0)if("undefined"===typeof b)this.first().trigger("contextmenu");else if("undefined"!==typeof b.x&&"undefined"!==typeof b.y)this.first().trigger(a.Event("contextmenu",{pageX:b.x,pageY:b.y,mouseButton:b.button}));else if("hide"===b){var e=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;e&&e.trigger("contextmenu:hide")}else"destroy"===b?a.contextMenu("destroy",{context:this}):a.isPlainObject(b)?(b.context=this,a.contextMenu("create",b)):b?this.removeClass("context-menu-disabled"):b||this.addClass("context-menu-disabled");else a.each(g,function(){this.selector===c.selector&&(d.data=this,a.extend(d.data,{trigger:"demand"}))}),l.contextmenu.call(d.target,d);return this},a.contextMenu=function(b,d){"string"!==typeof b&&(d=b,b="create"),"string"===typeof d?d={selector:d}:"undefined"===typeof d&&(d={});var h=a.extend(!0,{},i,d||{}),j=a(document),k=j,n=!1;switch(h.context&&h.context.length?(k=a(h.context).first(),h.context=k.get(0),n=!a(h.context).is(document)):h.context=document,b){case"update":if(n)m.update(k);else for(var o in g)g.hasOwnProperty(o)&&m.update(g[o]);break;case"create":if(!h.selector)throw new Error("No selector specified");if(h.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+h.selector+'" as it contains a reserved className');if(!h.build&&(!h.items||a.isEmptyObject(h.items)))throw new Error("No Items specified");if(e++,h.ns=".contextMenu"+e,n||(f[h.selector]=h.ns),g[h.ns]=h,h.trigger||(h.trigger="right"),!c){var p="click"===h.itemClickEvent?"click.contextMenu":"mouseup.contextMenu",q={"contextmenu:focus.contextMenu":l.focusItem,"contextmenu:blur.contextMenu":l.blurItem,"contextmenu.contextMenu":l.abortevent,"mouseenter.contextMenu":l.itemMouseenter,"mouseleave.contextMenu":l.itemMouseleave};q[p]=l.itemClick,j.on({"contextmenu:hide.contextMenu":l.hideMenu,"prevcommand.contextMenu":l.prevItem,"nextcommand.contextMenu":l.nextItem,"contextmenu.contextMenu":l.abortevent,"mouseenter.contextMenu":l.menuMouseenter,"mouseleave.contextMenu":l.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",l.inputClick).on(q,".context-menu-item"),c=!0}switch(k.on("contextmenu"+h.ns,h.selector,h,l.contextmenu),n&&k.on("remove"+h.ns,function(){a(this).contextMenu("destroy")}),h.trigger){case"hover":k.on("mouseenter"+h.ns,h.selector,h,l.mouseenter).on("mouseleave"+h.ns,h.selector,h,l.mouseleave);break;case"left":k.on("click"+h.ns,h.selector,h,l.click);break;case"touchstart":k.on("touchstart"+h.ns,h.selector,h,l.click)}h.build||m.create(h);break;case"destroy":var r;if(n){var s=h.context;a.each(g,function(b,c){if(!c)return!0;if(!a(s).is(c.selector))return!0;r=a(".context-menu-list").filter(":visible"),r.length&&r.data().contextMenuRoot.$trigger.is(a(c.context).find(c.selector))&&r.trigger("contextmenu:hide",{force:!0});try{g[c.ns].$menu&&g[c.ns].$menu.remove(),delete g[c.ns]}catch(d){g[c.ns]=null}return a(c.context).off(c.ns),!0})}else if(h.selector){if(f[h.selector]){r=a(".context-menu-list").filter(":visible"),r.length&&r.data().contextMenuRoot.$trigger.is(h.selector)&&r.trigger("contextmenu:hide",{force:!0});try{g[f[h.selector]].$menu&&g[f[h.selector]].$menu.remove(),delete g[f[h.selector]]}catch(t){g[f[h.selector]]=null}j.off(f[h.selector])}}else j.off(".contextMenu .contextMenuAutoHide"),a.each(g,function(b,c){a(c.context).off(c.ns)}),f={},g={},e=0,c=!1,a("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!a.support.htmlCommand&&!a.support.htmlMenuitem||"boolean"===typeof d&&d)&&a('menu[type="context"]').each(function(){this.id&&a.contextMenu({selector:"[contextmenu="+this.id+"]",items:a.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+b+'"')}return this},a.contextMenu.setInputValues=function(b,c){"undefined"===typeof c&&(c={}),a.each(b.inputs,function(a,b){switch(b.type){case"text":case"textarea":b.value=c[a]||"";break;case"checkbox":b.selected=c[a]?!0:!1;break;case"radio":b.selected=(c[b.radio]||"")===b.value;break;case"select":b.selected=c[a]||""}})},a.contextMenu.getInputValues=function(b,c){return"undefined"===typeof c&&(c={}),a.each(b.inputs,function(a,b){switch(b.type){case"text":case"textarea":case"select":c[a]=b.$input.val();break;case"checkbox":c[a]=b.$input.prop("checked");break;case"radio":b.$input.prop("checked")&&(c[b.radio]=b.value)}}),c},a.contextMenu.fromMenu=function(b){var c=a(b),d={};return p(d,c.children()),d},a.contextMenu.defaults=i,a.contextMenu.types=h,a.contextMenu.handle=l,a.contextMenu.op=m,a.contextMenu.menus=g});